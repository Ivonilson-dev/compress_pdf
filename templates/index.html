<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF compress</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; padding-top: 20px; }
        .card { margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .result-card { background-color: #e8f5e9; }
        .stat-box { background-color: white; border-radius: 8px; padding: 15px; margin: 10px 0; }
        .alert { margin-top: 20px; }
        .instructions { background-color: #fff3cd; border-left: 4px solid #ffc107; padding: 15px; margin: 20px 0; }
    </style>
</head>
<body>
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <!-- Cabe√ßalho -->
                <div class="text-center mb-4">
                    <h1 class="text-primary">Compress√£o PDF</h1>
                    <p class="lead">Comprime PDFs sem perda de qualidade vis√≠vel</p>
                </div>

                <!-- Avisos -->
                {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                        {% for category, message in messages %}
                            <div class="alert alert-{{ 'danger' if category == 'error' else 'warning' if category == 'warning' else 'success' }} alert-dismissible fade show">
                                {{ message }}
                                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                            </div>
                        {% endfor %}
                    {% endif %}
                {% endwith %}

                <!-- Instru√ß√µes Ghostscript -->
                {% if not ghostscript_installed %}
                <div class="instructions">
                    <h4>‚ö†Ô∏è Ghostscript N√£o Encontrado</h4>
                    <p>Para usar esta ferramenta, instale o Ghostscript primeiro:</p>
                    <ul>
                        <li><strong>Windows:</strong> Baixe do <a href="https://ghostscript.com/releases/gsdnld.html" target="_blank">site oficial</a></li>
                        <li><strong>macOS:</strong> <code>brew install ghostscript</code></li>
                        <li><strong>Linux (Debian/Ubuntu):</strong> <code>sudo apt install ghostscript</code></li>
                        <li><strong>Linux (Fedora):</strong> <code>sudo dnf install ghostscript</code></li>
                    </ul>
                    <p class="mb-0">Ap√≥s instalar, reinicie esta aplica√ß√£o.</p>
                </div>
                {% endif %}

                <!-- Formul√°rio de Upload -->
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0">Comprimir PDF</h5>
                    </div>
                    <div class="card-body">
                        <form method="POST" enctype="multipart/form-data">
                            <!-- Sele√ß√£o de Arquivo -->
                            <div class="mb-3">
                                <label for="pdf_file" class="form-label">Selecione um arquivo PDF</label>
                                <input type="file" class="form-control" id="pdf_file" name="pdf_file" accept=".pdf" required>
                                <div class="form-text">Tamanho m√°ximo: 50MB</div>
                            </div>

                            <!-- Perfil de Compress√£o -->
                            <div class="mb-3">
                                <label class="form-label">Perfil de Compress√£o</label>
                                {% for key, profile in profiles.items() %}
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="radio" name="profile" 
                                           id="profile_{{ key }}" value="{{ key }}" 
                                           {{ 'checked' if key == 'ebook' }}>
                                    <label class="form-check-label" for="profile_{{ key }}">
                                        <strong>{{ profile.name }}</strong> - {{ profile.description }}
                                    </label>
                                </div>
                                {% endfor %}
                            </div>

                            <!-- Bot√£o de Envio -->
                            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                                <button type="submit" class="btn btn-primary" 
                                        {{ 'disabled' if not ghostscript_installed }}>
                                    Comprimir PDF
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Resultados -->
                {% if results %}
                <div class="card result-card">
                    <div class="card-header bg-success text-white">
                        <h5 class="mb-0">Resultados da Compress√£o</h5>
                    </div>
                    <div class="card-body">
                        <!-- Estat√≠sticas -->
                        <div class="row text-center">
                            <div class="col-md-4">
                                <div class="stat-box">
                                    <h6>Original</h6>
                                    <h4 class="text-muted">{{ results.original_size }}</h4>
                                    <small class="text-muted">{{ results.original_name }}</small>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="stat-box">
                                    <h6>Comprimido</h6>
                                    <h4 class="text-success">{{ results.compressed_size }}</h4>
                                    <small class="text-muted">{{ results.compressed_name }}</small>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="stat-box">
                                    <h6>Redu√ß√£o</h6>
                                    <h4 class="text-danger">{{ results.reduction }}</h4>
                                    <small class="text-muted">{{ results.profile_used }}</small>
                                </div>
                            </div>
                        </div>

                        <!-- Bot√µes de A√ß√£o -->
                        <div class="d-flex justify-content-between mt-4">
                            <a href="{{ url_for('download_file', filename=results.compressed_name) }}" 
                               class="btn btn-success">
                                üì• Baixar PDF Comprimido
                            </a>
                            <form method="POST" action="{{ url_for('cleanup') }}">
                                <button type="submit" class="btn btn-outline-danger">
                                    üóëÔ∏è Limpar Arquivos
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
                {% endif %}

                <!-- Informa√ß√µes 
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">Como Funciona</h5>
                    </div>
                    <div class="card-body">
                        <p>Esta ferramenta usa o <strong>Ghostscript</strong> para recompress√£o inteligente de PDFs:</p>
                        <ul>
                            <li><strong>Prepress:</strong> Mant√©m alta qualidade para impress√£o profissional</li>
                            <li><strong>E-book:</strong> Equil√≠brio ideal entre qualidade e tamanho</li>
                            <li><strong>Tela:</strong> Compress√£o m√°xima para uso na web</li>
                        </ul>
                        <p class="mb-0"><small>Os PDFs originais e comprimidos s√£o armazenados temporariamente e podem ser removidos com o bot√£o "Limpar Arquivos".</small></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    -->

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>